

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Consensus.EsriConnector module &mdash; Consensus 1.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=6efca38a"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Consensus.EsriServers module" href="Consensus.EsriServers.html" />
    <link rel="prev" title="Consensus.ConfigManager module" href="Consensus.ConfigManager.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Consensus
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Consensus</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Consensus.ConfigManager.html">Consensus.ConfigManager module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Consensus.EsriConnector module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#extending-esriconnector-class">Extending <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#featureserver-class-example"><code class="docutils literal notranslate"><span class="pre">FeatureServer()</span></code> class example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector"><code class="docutils literal notranslate"><span class="pre">EsriConnector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.base_url"><code class="docutils literal notranslate"><span class="pre">EsriConnector.base_url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.max_retries"><code class="docutils literal notranslate"><span class="pre">EsriConnector.max_retries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.retry_delay"><code class="docutils literal notranslate"><span class="pre">EsriConnector.retry_delay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.server_types"><code class="docutils literal notranslate"><span class="pre">EsriConnector.server_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.services"><code class="docutils literal notranslate"><span class="pre">EsriConnector.services</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.service_table"><code class="docutils literal notranslate"><span class="pre">EsriConnector.service_table</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector._name"><code class="docutils literal notranslate"><span class="pre">EsriConnector._name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector._initialise"><code class="docutils literal notranslate"><span class="pre">EsriConnector._initialise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector._load_all_services"><code class="docutils literal notranslate"><span class="pre">EsriConnector._load_all_services()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.print_all_services"><code class="docutils literal notranslate"><span class="pre">EsriConnector.print_all_services()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.__init__"><code class="docutils literal notranslate"><span class="pre">EsriConnector.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector._fetch_response"><code class="docutils literal notranslate"><span class="pre">EsriConnector._fetch_response()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">EsriConnector._initialise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">EsriConnector._load_all_services()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">EsriConnector._name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">EsriConnector.base_url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.build_lookup"><code class="docutils literal notranslate"><span class="pre">EsriConnector.build_lookup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.connect_to_server"><code class="docutils literal notranslate"><span class="pre">EsriConnector.connect_to_server()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.field_matching_condition"><code class="docutils literal notranslate"><span class="pre">EsriConnector.field_matching_condition()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.get_layer_obj"><code class="docutils literal notranslate"><span class="pre">EsriConnector.get_layer_obj()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.metadata_as_pandas"><code class="docutils literal notranslate"><span class="pre">EsriConnector.metadata_as_pandas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">EsriConnector.print_all_services()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.print_object_data"><code class="docutils literal notranslate"><span class="pre">EsriConnector.print_object_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.select_layers_by_layers"><code class="docutils literal notranslate"><span class="pre">EsriConnector.select_layers_by_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.EsriConnector.select_layers_by_service"><code class="docutils literal notranslate"><span class="pre">EsriConnector.select_layers_by_service()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer"><code class="docutils literal notranslate"><span class="pre">FeatureServer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.feature_service"><code class="docutils literal notranslate"><span class="pre">FeatureServer.feature_service</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.max_retries"><code class="docutils literal notranslate"><span class="pre">FeatureServer.max_retries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.retry_delay"><code class="docutils literal notranslate"><span class="pre">FeatureServer.retry_delay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.chunk_size"><code class="docutils literal notranslate"><span class="pre">FeatureServer.chunk_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.__init__"><code class="docutils literal notranslate"><span class="pre">FeatureServer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.chunker"><code class="docutils literal notranslate"><span class="pre">FeatureServer.chunker()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.download"><code class="docutils literal notranslate"><span class="pre">FeatureServer.download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.looper"><code class="docutils literal notranslate"><span class="pre">FeatureServer.looper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.FeatureServer.setup"><code class="docutils literal notranslate"><span class="pre">FeatureServer.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Consensus.EsriConnector.Layer"><code class="docutils literal notranslate"><span class="pre">Layer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.full_name"><code class="docutils literal notranslate"><span class="pre">Layer.full_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.service_name"><code class="docutils literal notranslate"><span class="pre">Layer.service_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.layer_name"><code class="docutils literal notranslate"><span class="pre">Layer.layer_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.id"><code class="docutils literal notranslate"><span class="pre">Layer.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.fields"><code class="docutils literal notranslate"><span class="pre">Layer.fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.url"><code class="docutils literal notranslate"><span class="pre">Layer.url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.description"><code class="docutils literal notranslate"><span class="pre">Layer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.primary_key"><code class="docutils literal notranslate"><span class="pre">Layer.primary_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.matchable_fields"><code class="docutils literal notranslate"><span class="pre">Layer.matchable_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.lasteditdate"><code class="docutils literal notranslate"><span class="pre">Layer.lasteditdate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.data_from_layers"><code class="docutils literal notranslate"><span class="pre">Layer.data_from_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.has_geometry"><code class="docutils literal notranslate"><span class="pre">Layer.has_geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.type"><code class="docutils literal notranslate"><span class="pre">Layer.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer.__init__"><code class="docutils literal notranslate"><span class="pre">Layer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer._fetch"><code class="docutils literal notranslate"><span class="pre">Layer._fetch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Layer._record_count"><code class="docutils literal notranslate"><span class="pre">Layer._record_count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">Layer.data_from_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">Layer.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">Layer.fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">Layer.full_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">Layer.has_geometry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">Layer.id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">Layer.lasteditdate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">Layer.layer_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">Layer.matchable_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">Layer.primary_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">Layer.service_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">Layer.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">Layer.url</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Consensus.EsriConnector.Service"><code class="docutils literal notranslate"><span class="pre">Service</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.name"><code class="docutils literal notranslate"><span class="pre">Service.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.type"><code class="docutils literal notranslate"><span class="pre">Service.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.url"><code class="docutils literal notranslate"><span class="pre">Service.url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.description"><code class="docutils literal notranslate"><span class="pre">Service.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.layers"><code class="docutils literal notranslate"><span class="pre">Service.layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.tables"><code class="docutils literal notranslate"><span class="pre">Service.tables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.output_formats"><code class="docutils literal notranslate"><span class="pre">Service.output_formats</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.metadata"><code class="docutils literal notranslate"><span class="pre">Service.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.fields"><code class="docutils literal notranslate"><span class="pre">Service.fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.primary_key"><code class="docutils literal notranslate"><span class="pre">Service.primary_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.field_matching_condition"><code class="docutils literal notranslate"><span class="pre">Service.field_matching_condition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.featureservers"><code class="docutils literal notranslate"><span class="pre">Service.featureservers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.mapservers"><code class="docutils literal notranslate"><span class="pre">Service.mapservers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.wfsservers"><code class="docutils literal notranslate"><span class="pre">Service.wfsservers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.get_download_urls"><code class="docutils literal notranslate"><span class="pre">Service.get_download_urls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service._matchable_fields"><code class="docutils literal notranslate"><span class="pre">Service._matchable_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.__init__"><code class="docutils literal notranslate"><span class="pre">Service.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service._fetch"><code class="docutils literal notranslate"><span class="pre">Service._fetch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">Service._matchable_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service._service_attributes"><code class="docutils literal notranslate"><span class="pre">Service._service_attributes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">Service.description</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">Service.featureservers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">Service.field_matching_condition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">Service.fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">Service.get_download_urls()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.get_layers"><code class="docutils literal notranslate"><span class="pre">Service.get_layers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">Service.layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">Service.mapservers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">Service.metadata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">Service.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">Service.output_formats</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">Service.primary_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.service_details"><code class="docutils literal notranslate"><span class="pre">Service.service_details()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Consensus.EsriConnector.Service.service_metadata"><code class="docutils literal notranslate"><span class="pre">Service.service_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">Service.tables</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id31"><code class="docutils literal notranslate"><span class="pre">Service.type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">Service.url</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">Service.wfsservers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.EsriServers.html">Consensus.EsriServers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.GeocodeMerger.html">Consensus.GeocodeMerger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.LGInform.html">Consensus.LGInform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.LocalMerger.html">Consensus.LocalMerger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.Nomis.html">Consensus.Nomis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.config_utils.html">Consensus.config_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.utils.html">Consensus.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.server_selector_util.html">Consensus.server_selector_util module</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.config.html">Consensus.config folder</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.lookups.html">Consensus.lookups folder</a></li>
<li class="toctree-l2"><a class="reference internal" href="Consensus.PickleJar.html">Consensus.PickleJar folder</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Consensus</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Consensus</a></li>
      <li class="breadcrumb-item active">Consensus.EsriConnector module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Consensus.EsriConnector.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-Consensus.EsriConnector">
<span id="consensus-esriconnector-module"></span><h1>Consensus.EsriConnector module<a class="headerlink" href="#module-Consensus.EsriConnector" title="Link to this heading"></a></h1>
<section id="extending-esriconnector-class">
<h2>Extending <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> class<a class="headerlink" href="#extending-esriconnector-class" title="Link to this heading"></a></h2>
<p>This module provides a class for interacting with the Esri REST API. This is the basic building block that the Consensus package uses to interact with Esri REST APIs such as Open Geography Portal and TfL Open Data Hub. It is designed to be extended to provide additional functionality, such as custom methods for specific use cases. It creates a dictionary of Service objects given the URL of the server and lets you add methods to extract the metadata for any of them. You can apply the <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> class to a new server by calling <code class="docutils literal notranslate"><span class="pre">my_new_connection=EsriConnector(base_url=your_new_server,</span> <span class="pre">_name=New_Server)</span></code> or by creating a separate class if you so wish:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.EsriConnector</span><span class="w"> </span><span class="kn">import</span> <span class="n">EsriConnector</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NewServer</span><span class="p">(</span><span class="n">EsriConnector</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">retry_delay</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">max_retries</span><span class="p">,</span> <span class="n">retry_delay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">your_new_server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">New_Server</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Connecting to </span><span class="si">{</span><span class="n">your_new_server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">field_matching_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># accept only fields that end with &#39;CD&#39; or &#39;NM&#39;</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="s1">&#39;NM&#39;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">field_matching_condition()</span></code> is used when you build a lookup table of the data. In the lookup table, you can find two fields called “fields” and “matchable_fields”. By defining what <code class="docutils literal notranslate"><span class="pre">field_matching_condition()</span></code> does, you can refine which fields are included in the “matchable_fields” for all layers of all services that are available at a given ArcGIS server. The column names included in the “matchable_fields” are then used by the <code class="docutils literal notranslate"><span class="pre">SmartLinker()</span></code> class to create the graph of that server. If you do not want or need to use <code class="docutils literal notranslate"><span class="pre">SmartLinker()</span></code>, then you can ignore <code class="docutils literal notranslate"><span class="pre">field_matching_condition()</span></code>.</p>
<p>Note that all base URLs of your custom servers have to end in “?f=json”. Here’s a list of URLs that you can experiment with:</p>
<ul class="simple">
<li><p>[MetOffice]: <a class="reference external" href="https://services.arcgis.com/Lq3V5RFuTBC9I7kv/ArcGIS/rest/services?f=json">https://services.arcgis.com/Lq3V5RFuTBC9I7kv/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[National highways]: <a class="reference external" href="https://services-eu1.arcgis.com/mZXeBXkkZpekxjXT/ArcGIS/rest/services?f=json">https://services-eu1.arcgis.com/mZXeBXkkZpekxjXT/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[Natural England]: <a class="reference external" href="https://services.arcgis.com/JJzESW51TqeY9uat/ArcGIS/rest/services?f=json">https://services.arcgis.com/JJzESW51TqeY9uat/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[Historic England]: <a class="reference external" href="https://services-eu1.arcgis.com/ZOdPfBS3aqqDYPUQ/ArcGIS/rest/services?f=json">https://services-eu1.arcgis.com/ZOdPfBS3aqqDYPUQ/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[British Geological Survey]: <a class="reference external" href="https://services3.arcgis.com/7bJVHfju2RXdGZa4/ArcGIS/rest/services?f=json">https://services3.arcgis.com/7bJVHfju2RXdGZa4/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[Sustrans (National Cycle Network)]: <a class="reference external" href="https://services5.arcgis.com/1ZHcUS1lwPTg4ms0/ArcGIS/rest/services?f=json">https://services5.arcgis.com/1ZHcUS1lwPTg4ms0/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[RSPB]: <a class="reference external" href="https://services1.arcgis.com/h1C9f6qsGKmqXsVs/ArcGIS/rest/services?f=json">https://services1.arcgis.com/h1C9f6qsGKmqXsVs/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[Crown Estate (e.g. wind turbine agreements)]: <a class="reference external" href="https://services2.arcgis.com/PZklK9Q45mfMFuZs/ArcGIS/rest/services?f=json">https://services2.arcgis.com/PZklK9Q45mfMFuZs/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[National Trust]: <a class="reference external" href="https://services-eu1.arcgis.com/NPIbx47lsIiu2pqz/ArcGIS/rest/services?f=json">https://services-eu1.arcgis.com/NPIbx47lsIiu2pqz/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[UK Air]: <a class="reference external" href="https://ukair.maps.rcdo.co.uk/ukairserver/rest/services/Hosted?f=json">https://ukair.maps.rcdo.co.uk/ukairserver/rest/services/Hosted?f=json</a></p></li>
</ul>
<p>Even individual towns have their own ArcGIS servers:</p>
<ul class="simple">
<li><p>[Bristol]: <a class="reference external" href="https://services2.arcgis.com/a4vR8lmmksFixzmB/ArcGIS/rest/services?f=json">https://services2.arcgis.com/a4vR8lmmksFixzmB/ArcGIS/rest/services?f=json</a></p></li>
<li><p>[Aberdeen]: <a class="reference external" href="https://services5.arcgis.com/0sktPVp3t1LvXc9z/ArcGIS/rest/services?f=json">https://services5.arcgis.com/0sktPVp3t1LvXc9z/ArcGIS/rest/services?f=json</a></p></li>
</ul>
<p>Currently, there is no support for Esri ArcGIS servers that are not available to the public.</p>
</section>
<section id="featureserver-class-example">
<h2><code class="docutils literal notranslate"><span class="pre">FeatureServer()</span></code> class example<a class="headerlink" href="#featureserver-class-example" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">FeatureServer()</span></code> class on is used to download data from the Esri REST API. For example, to download the ward 2023 boundary data for Brockley in Lewisham from Open Geography Portal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.EsriConnector</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureServer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.EsriServers</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenGeography</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">where_clause_maker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">download_test_data</span><span class="p">():</span>
    <span class="n">og</span> <span class="o">=</span> <span class="n">OpenGeography</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">fs</span> <span class="o">=</span> <span class="n">FeatureServer</span><span class="p">()</span>

    <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;WD23NM&#39;</span>
    <span class="n">geographic_areas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Brockley&#39;</span><span class="p">]</span>
    <span class="n">service_name</span> <span class="o">=</span> <span class="s1">&#39;Wards_December_2023_Boundaries_UK_BSC&#39;</span>  <span class="c1"># we happen to know this in advance.</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">select_layers_by_service</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="n">service_name</span><span class="p">)</span>  <span class="c1"># choose the first layer of the &#39;Wards_December_2023_Boundaries_UK_BSC&#39; service</span>
    <span class="n">layer_full_name</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full_name</span>  <span class="c1"># use the layer&#39;s ``full_name`` attribute to select it in ``fs.setup()`` and when creating the ``where_clause``</span>

    <span class="n">where_clause</span> <span class="o">=</span> <span class="n">where_clause_maker</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">geographic_areas</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>  <span class="c1"># a helper function that creates the SQL where clause for Esri Servers</span>

    <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">full_name</span><span class="o">=</span><span class="n">layer_full_name</span><span class="p">,</span> <span class="n">esri_server</span><span class="o">=</span><span class="n">og</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">where_clause</span><span class="o">=</span><span class="n">where_clause</span><span class="p">,</span> <span class="n">return_geometry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">download_test_data</span><span class="p">())</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Consensus.EsriConnector.</span></span><span class="sig-name descname"><span class="pre">EsriConnector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'feature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchable_fields_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Main class for connecting to Esri servers. This class uses <code class="docutils literal notranslate"><span class="pre">Consensus.ConfigManager.ConfigManager()</span></code> to load the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file for proxies. Specifically, the class uses https proxy.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.base_url">
<span class="sig-name descname"><span class="pre">base_url</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.base_url" title="Link to this definition"></a></dt>
<dd><p>The base URL of the Esri server. Built-in modules that use <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> class set their own base_url.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.max_retries">
<span class="sig-name descname"><span class="pre">max_retries</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.max_retries" title="Link to this definition"></a></dt>
<dd><p>The maximum number of retries for HTTP requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.retry_delay">
<span class="sig-name descname"><span class="pre">retry_delay</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.retry_delay" title="Link to this definition"></a></dt>
<dd><p>The delay in seconds between retries.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.server_types">
<span class="sig-name descname"><span class="pre">server_types</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.server_types" title="Link to this definition"></a></dt>
<dd><p>A dictionary of server types and their corresponding suffixes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.services">
<span class="sig-name descname"><span class="pre">services</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.services" title="Link to this definition"></a></dt>
<dd><p>A list of Service objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#Consensus.EsriConnector.Service" title="Consensus.EsriConnector.Service">Service</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.service_table">
<span class="sig-name descname"><span class="pre">service_table</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.service_table" title="Link to this definition"></a></dt>
<dd><p>A Pandas DataFrame containing the service metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector._name">
<span class="sig-name descname"><span class="pre">_name</span></span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector._name" title="Link to this definition"></a></dt>
<dd><p>Name of the server. Must always be defined, else lookup tables cannot be created.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__(max_retries</span></span></dt>
<dd><p>int = 10, retry_delay: int = 2, server_type: str = ‘feature’, base_url: str = “”, proxy: str = None, matchable_fields_extension: List[str] = []): Initialise class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">field_matching_condition(field</span></span></dt>
<dd><p>Dict[str, str]): Condition for matchable fields. This method is used by <code class="docutils literal notranslate"><span class="pre">Service()</span></code> to filter the fields that are added to the matchable_fields columns, which is subsequently used by <code class="docutils literal notranslate"><span class="pre">SmartLinker()</span></code> for matching data tables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector._initialise">
<span class="sig-name descname"><span class="pre">_initialise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector._initialise" title="Link to this definition"></a></dt>
<dd><p>Initialise the service_table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_fetch_response(session</span></span></dt>
<dd><p>aiohttp.ClientSession): Helper method to get response from Esri server.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_layer_obj(service</span></span></dt>
<dd><p>Dict[str, str], session: aiohttp.ClientSession): Call the <code class="docutils literal notranslate"><span class="pre">get_layers()</span></code> method for a Service object to get the list of Layer objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector._load_all_services">
<span class="sig-name descname"><span class="pre">_load_all_services</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector._load_all_services" title="Link to this definition"></a></dt>
<dd><p>Load all services from the Esri server into <code class="docutils literal notranslate"><span class="pre">self.service_table</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">print_object_data(layer_obj</span></span></dt>
<dd><p>Layer): Print the object metadata.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.print_all_services">
<span class="sig-name descname"><span class="pre">print_all_services</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.print_all_services" title="Link to this definition"></a></dt>
<dd><p>Print all services from the Esri server.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">select_layers_by_service(service_name</span></span></dt>
<dd><p>str): Return the list of Layer objects for a given service.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">select_layers_by_layers(layer_name</span></span></dt>
<dd><p>str): Find all Layer objects that share the same name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">metadata_as_pandas(included_services</span></span></dt>
<dd><p>List[str] = []): Return the metadata of the services as a Pandas DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">build_lookup(parent_path</span></span></dt>
<dd><p>Path = Path(__file__).resolve().parent, included_services: List[str] = [], replace_old: bool = True): Build a lookup table of the services. This method will call <code class="docutils literal notranslate"><span class="pre">metadata_as_pandas()</span></code> for each service and return a Pandas DataFrame as well as builds a json lookup file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'feature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchable_fields_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialise class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_retries</strong> (<em>int</em>) – The maximum number of retries for HTTP requests. Defaults to 10.</p></li>
<li><p><strong>retry_delay</strong> (<em>int</em>) – The delay in seconds between retries. Defaults to 2.</p></li>
<li><p><strong>base_url</strong> (<em>str</em>) – The base URL of the Esri server. Defaults to “”. Built-in modules that use <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> class set their own base_url.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – The proxy URL to use for requests. Defaults to None. Leave empty to make use of <code class="docutils literal notranslate"><span class="pre">ConfigManager()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector._fetch_response">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_fetch_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector._fetch_response" title="Link to this definition"></a></dt>
<dd><p>Helper method to fetch the response from the Esri server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp.ClientSession object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The JSON response from the Esri server.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">_initialise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Initialise the class by either reading the saved service table from a pickle file or by setting it as an empty dictionary ready to be filled with <code class="docutils literal notranslate"><span class="pre">build_lookup()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_load_all_services</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Load services into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">base_url</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.build_lookup">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('/home/runner/work/Consensus/Consensus/Consensus')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">included_services</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_old</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.build_lookup" title="Link to this definition"></a></dt>
<dd><p>Build a lookup table from scratch and save it to a JSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parent_path</strong> (<em>Path</em>) – Parent path to save the service_table pickle and lookup files.</p></li>
<li><p><strong>included_services</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of services to include in the lookup. Defaults to [], which is interpreted as as ‘all’.</p></li>
<li><p><strong>replace_old</strong> (<em>bool</em>) – Whether to replace the old lookup file. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lookup table as a pandas DataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.connect_to_server">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connect_to_server</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.connect_to_server" title="Link to this definition"></a></dt>
<dd><p>Run this method to initialise the class session.
Validate access to the base URL asynchronously using aiohttp. When a response is received, call <code class="docutils literal notranslate"><span class="pre">_load_all_services()</span></code> to load services into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.field_matching_condition">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">field_matching_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.field_matching_condition" title="Link to this definition"></a></dt>
<dd><p>Condition for matchable fields. This method is used by <code class="docutils literal notranslate"><span class="pre">Service()</span></code> to filter the fields that are added to the matchable_fields columns, which is subsequently used by <code class="docutils literal notranslate"><span class="pre">SmartLinker()</span></code> for matching data tables.
This method is meant to be overwritten by the user if they want to change the condition for matchable fields. Each Esri ArcGIS server will have its own rules, so this will be left for the user to deal with.
If you are using a built-in server (e.g. TFL or Open Geography Portal), then you don’t have to touch this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>field</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – The field dictionary. This is the input coming from <code class="docutils literal notranslate"><span class="pre">Service()</span></code>. This method should always accept a metadata dictionary describing the field.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>default is True if the field name is in <code class="docutils literal notranslate"><span class="pre">matchable_fields_extension</span></code>, otherwise False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.get_layer_obj">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_layer_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.get_layer_obj" title="Link to this definition"></a></dt>
<dd><p>Fetch metadata for a service and add it to the service table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>service</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Dictionary of services.</p></li>
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp.ClientSession object.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.metadata_as_pandas">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata_as_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">included_services</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.metadata_as_pandas" title="Link to this definition"></a></dt>
<dd><p>Asynchronously create a Pandas DataFrame of selected tables’ metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>included_services</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of service names to include in the DataFrame. If empty, all services are included.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the metadata of the selected services.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">print_all_services</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Print name, type, and URL of all services available through Esri server.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.print_object_data">
<span class="sig-name descname"><span class="pre">print_object_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.print_object_data" title="Link to this definition"></a></dt>
<dd><p>Print the data of a Layer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_obj</strong> (<a class="reference internal" href="#Consensus.EsriConnector.Layer" title="Consensus.EsriConnector.Layer"><em>Layer</em></a>) – The Layer object to print.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>Added in version 1.1.1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.select_layers_by_layers">
<span class="sig-name descname"><span class="pre">select_layers_by_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.select_layers_by_layers" title="Link to this definition"></a></dt>
<dd><p>Print a subset of the service table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>layer_name</strong> (<em>str</em>) – The name of the layer to print.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of Layer objects for the selected service.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
</dl>
<p>Added in version 1.1.0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.EsriConnector.select_layers_by_service">
<span class="sig-name descname"><span class="pre">select_layers_by_service</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">service_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.EsriConnector.select_layers_by_service" title="Link to this definition"></a></dt>
<dd><p>Print and output a subset of the service table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>service_name</strong> (<em>str</em>) – The name of the service to print.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of Layer objects for the selected service.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Any]</p>
</dd>
</dl>
<p>Added in version 1.1.0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Consensus.EsriConnector.</span></span><span class="sig-name descname"><span class="pre">FeatureServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Download data from an Esri Feature Server asynchronously. This class uses <code class="docutils literal notranslate"><span class="pre">Consensus.ConfigManager.ConfigManager()</span></code> to load the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file for proxies. Specifically, the class uses https proxy.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.feature_service">
<span class="sig-name descname"><span class="pre">feature_service</span></span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.feature_service" title="Link to this definition"></a></dt>
<dd><p>The Layer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#Consensus.EsriConnector.Layer" title="Consensus.EsriConnector.Layer">Layer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.max_retries">
<span class="sig-name descname"><span class="pre">max_retries</span></span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.max_retries" title="Link to this definition"></a></dt>
<dd><p>The maximum number of retries for a request.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.retry_delay">
<span class="sig-name descname"><span class="pre">retry_delay</span></span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.retry_delay" title="Link to this definition"></a></dt>
<dd><p>The delay in seconds between retries.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.chunk_size">
<span class="sig-name descname"><span class="pre">chunk_size</span></span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.chunk_size" title="Link to this definition"></a></dt>
<dd><p>The number of records to download in each chunk.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__(proxy</span></span></dt>
<dd><p>str): Initialise class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">setup(full_name</span></span></dt>
<dd><p>str, service_name: str, layer_name: str, service_table: Dict[str, Service], max_retries: int, retry_delay: int, chunk_size: int): Set up the FeatureServer Service object for downloading. You must give either the full_name or service_name and layer_name, as well as the service_table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">looper(session</span></span></dt>
<dd><p>aiohttp.ClientSession, link_url: str, params: Dict[str, Any]): Method to keep attempting to download data if connection lost.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">chunker(session</span></span></dt>
<dd><p>aiohttp.ClientSession, params: Dict[str, Any]): Splits the download by <code class="docutils literal notranslate"><span class="pre">chunk_size</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">download(fileformat</span></span></dt>
<dd><p>str, return_geometry: bool, where_clause: str, output_fields: str, params: Dict[str, str], n_sample_rows: int): Download data from the FeatureServer asynchronously.</p>
</dd></dl>

<dl>
<dt>Usage:</dt><dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In this example, we&#39;re using ``OpenGeography()`` sub-class</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.EsriConnector</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureServer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.EsriServers</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenGeography</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Consensus.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">where_clause_maker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">download_test_data</span><span class="p">():</span>
    <span class="n">og</span> <span class="o">=</span> <span class="n">OpenGeography</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="n">FeatureServer</span><span class="p">()</span>

    <span class="n">column_name</span> <span class="o">=</span> <span class="s1">&#39;WD23NM&#39;</span>
    <span class="n">geographic_areas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Brockley&#39;</span><span class="p">]</span>
    <span class="n">service_name</span> <span class="o">=</span> <span class="s1">&#39;Wards_December_2023_Boundaries_UK_BSC&#39;</span>

    <span class="n">layers</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">select_layers_by_service</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="n">service_name</span><span class="p">)</span>  <span class="c1"># choose the first layer of the &#39;Wards_December_2023_Boundaries_UK_BSC&#39; service</span>
    <span class="n">layer_full_name</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">full_name</span>  <span class="c1"># use the layer&#39;s ``full_name`` attribute to select it in ``fs.setup()`` and when creating the ``where_clause``</span>

    <span class="n">where_clause</span> <span class="o">=</span> <span class="n">where_clause_maker</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">geographic_areas</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">column_name</span><span class="p">)</span>  <span class="c1"># a helper function that creates the SQL where clause for Esri Servers</span>

    <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">full_name</span><span class="o">=</span><span class="n">layer_full_name</span><span class="p">,</span> <span class="n">esri_server</span><span class="o">=</span><span class="n">og</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="k">await</span> <span class="n">fs</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">where_clause</span><span class="o">=</span><span class="n">where_clause</span><span class="p">,</span> <span class="n">return_geometry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">download_test_data</span><span class="p">())</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialise class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>proxy</strong> (<em>str</em>) – The proxy URL to use for requests. Defaults to None. Leave empty to make use of <code class="docutils literal notranslate"><span class="pre">ConfigManager()</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.chunker">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">chunker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.chunker" title="Link to this definition"></a></dt>
<dd><p>Download data in chunks asynchronously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – The parameters for the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The downloaded data as a dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.download">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileformat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'geojson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where_clause</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1=1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sample_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.download" title="Link to this definition"></a></dt>
<dd><p>Download data from Esri server asynchronously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileformat</strong> (<em>str</em>) – The format of the downloaded data (‘geojson’, ‘json’, or ‘csv’). Perhaps best kept as geojson.</p></li>
<li><p><strong>return_geometry</strong> (<em>bool</em>) – Whether to include geometry in the downloaded data.</p></li>
<li><p><strong>where_clause</strong> (<em>str</em>) – The where clause to filter the data.</p></li>
<li><p><strong>output_fields</strong> (<em>str</em>) – The fields to include in the downloaded data.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Additional parameters for the query.</p></li>
<li><p><strong>n_sample_rows</strong> (<em>int</em>) – The number of rows to sample for testing purposes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The downloaded data as a pandas DataFrame or geopandas GeoDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.looper">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">looper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.looper" title="Link to this definition"></a></dt>
<dd><p>Keep trying to connect to Feature Service until max_retries or response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session.</p></li>
<li><p><strong>link_url</strong> (<em>str</em>) – The URL of the Feature Server service.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – The parameters for the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The downloaded data as a dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.FeatureServer.setup">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esri_server</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('/home/runner/work/Consensus/Consensus/Consensus')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.FeatureServer.setup" title="Link to this definition"></a></dt>
<dd><p>Set up the FeatureServer Service object for downloading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_name</strong> (<em>str</em>) – The full name of the Feature Server service. Provide a value for either this argument or alternatively to <code class="docutils literal notranslate"><span class="pre">service_name</span></code> and <code class="docutils literal notranslate"><span class="pre">layer_name</span></code>, which the method builds the <code class="docutils literal notranslate"><span class="pre">full_name</span></code>.</p></li>
<li><p><strong>service_name</strong> (<em>str</em>) – The name of the Feature Server service. Provide a value together with <code class="docutils literal notranslate"><span class="pre">layer_name</span></code>.</p></li>
<li><p><strong>layer_name</strong> (<em>str</em>) – The name of the layer to download. Provide a value together with <code class="docutils literal notranslate"><span class="pre">service_name</span></code>.</p></li>
<li><p><strong>esri_server</strong> (<em>str</em>) – Mandatory. The name of the server to be used. This should match the name of the lookup file. For instance, for Open Geography Portal, the name is Open_Geography_Portal</p></li>
<li><p><strong>max_retries</strong> (<em>int</em>) – The maximum number of retries for a request.</p></li>
<li><p><strong>retry_delay</strong> (<em>int</em>) – The delay in seconds between retries.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em>) – The number of records to download in each chunk.</p></li>
<li><p><strong>parent_path</strong> (<em>Path</em>) – Parent path to save the service_table pickle and lookup files.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Consensus.EsriConnector.</span></span><span class="sig-name descname"><span class="pre">Layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchable_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lasteditdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_from_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Layer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass for layers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.full_name">
<span class="sig-name descname"><span class="pre">full_name</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.full_name" title="Link to this definition"></a></dt>
<dd><p>The full name of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.service_name">
<span class="sig-name descname"><span class="pre">service_name</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.service_name" title="Link to this definition"></a></dt>
<dd><p>The name of the service the layer belongs to.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.layer_name">
<span class="sig-name descname"><span class="pre">layer_name</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.layer_name" title="Link to this definition"></a></dt>
<dd><p>The name of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.id" title="Link to this definition"></a></dt>
<dd><p>The ID of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.fields" title="Link to this definition"></a></dt>
<dd><p>The list of fields in the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.url">
<span class="sig-name descname"><span class="pre">url</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.url" title="Link to this definition"></a></dt>
<dd><p>The URL of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.description">
<span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.description" title="Link to this definition"></a></dt>
<dd><p>The description of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.primary_key">
<span class="sig-name descname"><span class="pre">primary_key</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.primary_key" title="Link to this definition"></a></dt>
<dd><p>The primary key of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.matchable_fields">
<span class="sig-name descname"><span class="pre">matchable_fields</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.matchable_fields" title="Link to this definition"></a></dt>
<dd><p>The list of matchable fields in the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.lasteditdate">
<span class="sig-name descname"><span class="pre">lasteditdate</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.lasteditdate" title="Link to this definition"></a></dt>
<dd><p>The last edit date of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.data_from_layers">
<span class="sig-name descname"><span class="pre">data_from_layers</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.data_from_layers" title="Link to this definition"></a></dt>
<dd><p>Whether the layer is from a data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.has_geometry">
<span class="sig-name descname"><span class="pre">has_geometry</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.has_geometry" title="Link to this definition"></a></dt>
<dd><p>Whether the layer has geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.type">
<span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#Consensus.EsriConnector.Layer.type" title="Link to this definition"></a></dt>
<dd><p>The type of the layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_record_count(session</span></span></dt>
<dd><p>aiohttp.ClientSession, proxy: str): Helper method for asynchronous GET requests using aiohttp. This is used by the FeatureServer class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_fetch(session</span></span></dt>
<dd><p>aiohttp.ClientSession, url: str, params: Dict[str, str] = None, proxy: str = None): Helper method for asynchronous GET requests using aiohttp.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">service_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matchable_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lasteditdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_from_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Layer.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer._fetch">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Layer._fetch" title="Link to this definition"></a></dt>
<dd><p>Helper method for asynchronous GET requests using aiohttp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The URL to fetch.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Query parameters. Defaults to None.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The response as a JSON object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Layer._record_count">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_record_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Layer._record_count" title="Link to this definition"></a></dt>
<dd><p>Helper method for counting records.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The URL to fetch.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Query parameters.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string that is passed to <code class="docutils literal notranslate"><span class="pre">_fetch()</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The count of records for the chosen FeatureService</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">data_from_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">full_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">has_geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">lasteditdate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">layer_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">matchable_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">primary_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">service_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">url</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Consensus.EsriConnector.</span></span><span class="sig-name descname"><span class="pre">Service</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_matching_condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass for services.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.name" title="Link to this definition"></a></dt>
<dd><p>Name of service.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.type">
<span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.type" title="Link to this definition"></a></dt>
<dd><p>One of ‘FeatureServer’, ‘MapServer’, ‘WFSServer’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.url">
<span class="sig-name descname"><span class="pre">url</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.url" title="Link to this definition"></a></dt>
<dd><p>URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.description">
<span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.description" title="Link to this definition"></a></dt>
<dd><p>Description of the service.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.layers">
<span class="sig-name descname"><span class="pre">layers</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.layers" title="Link to this definition"></a></dt>
<dd><p>Data available through service. If empty, it is likely that the ‘tables’ attribute contains the desired data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.tables">
<span class="sig-name descname"><span class="pre">tables</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.tables" title="Link to this definition"></a></dt>
<dd><p>Data available through service. If empty, it is likely that the ‘layers’ attribute contains the desired data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Dict[str, Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.output_formats">
<span class="sig-name descname"><span class="pre">output_formats</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.output_formats" title="Link to this definition"></a></dt>
<dd><p>List of formats available for the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.metadata" title="Link to this definition"></a></dt>
<dd><p>Metadata as JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>json</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.fields" title="Link to this definition"></a></dt>
<dd><p>List of fields for the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.primary_key">
<span class="sig-name descname"><span class="pre">primary_key</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.primary_key" title="Link to this definition"></a></dt>
<dd><p>Primary key for the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.field_matching_condition">
<span class="sig-name descname"><span class="pre">field_matching_condition</span></span><a class="headerlink" href="#Consensus.EsriConnector.Service.field_matching_condition" title="Link to this definition"></a></dt>
<dd><p>Condition for matchable fields. This method is used by <code class="docutils literal notranslate"><span class="pre">Service()</span></code> to filter the fields that are added to the matchable_fields columns, which is subsequently used by <code class="docutils literal notranslate"><span class="pre">SmartLinker()</span></code> for matching data tables. You can define your own <code class="docutils literal notranslate"><span class="pre">field_matching_condition()</span></code> method for each Esri server by extending the relevant <code class="docutils literal notranslate"><span class="pre">EsriConnector()</span></code> sub-class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Dict[str, str]], bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.featureservers">
<span class="sig-name descname"><span class="pre">featureservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.featureservers" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.mapservers">
<span class="sig-name descname"><span class="pre">mapservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.mapservers" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.wfsservers">
<span class="sig-name descname"><span class="pre">wfsservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.wfsservers" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_fetch(session</span></span></dt>
<dd><p>aiohttp.ClientSession, url: str, params: Dict[str, str] = None, proxy: str = None): Helper method for asynchronous GET requests using aiohttp.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">service_details(session</span></span></dt>
<dd><p>aiohttp.ClientSession, proxy: str): Helper method for asynchronous GET requests using aiohttp. Gets more details about the service.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.get_download_urls">
<span class="sig-name descname"><span class="pre">get_download_urls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.get_download_urls" title="Link to this definition"></a></dt>
<dd><p>Helper method for getting download URLs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">service_metadata(self,</span> <span class="pre">session</span></span></dt>
<dd><p>aiohttp.ClientSession, proxy: str):  Helper method for asynchronous GET requests using aiohttp. Gets the metadata for the service.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service._matchable_fields">
<span class="sig-name descname"><span class="pre">_matchable_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service._matchable_fields" title="Link to this definition"></a></dt>
<dd><p>Gets the matchable fields for the service based on the <code class="docutils literal notranslate"><span class="pre">field_matching_condition()</span></code> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">_service_attributes(session</span></span></dt>
<dd><p>aiohttp.ClientSession, proxy): Helper method for asynchronous GET requests using aiohttp. Gets the attributes for the service.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_layers(session</span></span></dt>
<dd><p>aiohttp.ClientSession, proxy: str): Main method that creates the lookup data format for the service.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_formats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_matching_condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service._fetch">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service._fetch" title="Link to this definition"></a></dt>
<dd><p>Helper method for asynchronous GET requests using aiohttp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>url</strong> (<em>str</em>) – The URL to fetch.</p></li>
<li><p><strong>params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Query parameters. Defaults to None.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The response as a JSON object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_matchable_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Returns a list of matchable fields for the service. It uses the field_matching_condition() method that can be defined for any Esri ArcGIS server.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of matchable fields.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service._service_attributes">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_service_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service._service_attributes" title="Link to this definition"></a></dt>
<dd><p>Fills attribute fields using the JSON information from service_details and service_metadata methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string that is passed to <code class="docutils literal notranslate"><span class="pre">_fetch()</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">featureservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self if type is ‘FeatureServer’ else None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#Consensus.EsriConnector.Service" title="Consensus.EsriConnector.Service">Service</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">field_matching_condition</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code><span class="pre">[[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]],</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_download_urls</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Returns the download URL for the service.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of download URLs to visit.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.get_layers">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.get_layers" title="Link to this definition"></a></dt>
<dd><p>Returns a Pandas-ready dictionary of the service’s metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string that is passed to <code class="docutils literal notranslate"><span class="pre">_fetch()</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of the FeatureService’s metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, List]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">mapservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method. Currently unused.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self if type is ‘MapServer’ else None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#Consensus.EsriConnector.Service" title="Consensus.EsriConnector.Service">Service</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">output_formats</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">primary_key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.service_details">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">service_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.service_details" title="Link to this definition"></a></dt>
<dd><p>Returns high-level details for the data as JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string that is passed to <code class="docutils literal notranslate"><span class="pre">_fetch()</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The service details as a JSON object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Consensus.EsriConnector.Service.service_metadata">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">service_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Consensus.EsriConnector.Service.service_metadata" title="Link to this definition"></a></dt>
<dd><p>Returns metadata as JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>aiohttp.ClientSession</em>) – The aiohttp session object.</p></li>
<li><p><strong>proxy</strong> (<em>str</em>) – Proxy string that is passed to <code class="docutils literal notranslate"><span class="pre">_fetch()</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The metadata as a JSON object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">tables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id30" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">url</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">wfsservers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd><p>Self-filtering method. Currently unused.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self if type is ‘WFSServer’ else None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#Consensus.EsriConnector.Service" title="Consensus.EsriConnector.Service">Service</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Consensus.ConfigManager.html" class="btn btn-neutral float-left" title="Consensus.ConfigManager module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Consensus.EsriServers.html" class="btn btn-neutral float-right" title="Consensus.EsriServers module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Ilkka Sipila - Lewisham Council Data Science and Insight team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>